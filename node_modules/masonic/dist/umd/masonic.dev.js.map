{"version":3,"file":"masonic.dev.js","sources":["../../src/interval-tree.ts","../../node_modules/.pnpm/@react-hook+latest@1.0.3_react@17.0.2/node_modules/@react-hook/latest/src/index.tsx","../../node_modules/.pnpm/@react-hook+debounce@3.0.0_react@17.0.2/node_modules/@react-hook/debounce/src/index.tsx","../../node_modules/.pnpm/@react-hook+event@1.2.6_react@17.0.2/node_modules/@react-hook/event/src/index.tsx","../../node_modules/.pnpm/@react-hook+window-size@3.1.1_react@17.0.2/node_modules/@react-hook/window-size/src/index.tsx","../../node_modules/.pnpm/@essentials+memoize-one@1.1.0/node_modules/@essentials/memoize-one/src/index.ts","../../node_modules/.pnpm/@essentials+one-key-map@1.2.0/node_modules/@essentials/one-key-map/src/index.ts","../../node_modules/.pnpm/trie-memoize@1.2.0/node_modules/trie-memoize/src/index.ts","../../src/elements-cache.ts","../../src/use-force-update.ts","../../src/use-masonry.tsx","../../node_modules/.pnpm/@essentials+raf@1.2.0/node_modules/@essentials/raf/src/index.ts","../../node_modules/.pnpm/@essentials+request-timeout@1.3.0/node_modules/@essentials/request-timeout/src/index.ts","../../node_modules/.pnpm/@react-hook+throttle@2.2.0_react@17.0.2/node_modules/@react-hook/throttle/src/index.tsx","../../node_modules/.pnpm/@react-hook+window-scroll@1.3.0_react@17.0.2/node_modules/@react-hook/window-scroll/src/index.tsx","../../src/use-scroller.ts","../../src/masonry-scroller.tsx","../../node_modules/.pnpm/@react-hook+passive-layout-effect@1.2.1_react@17.0.2/node_modules/@react-hook/passive-layout-effect/src/index.tsx","../../src/use-container-position.ts","../../src/use-positioner.ts","../../node_modules/.pnpm/raf-schd@4.0.3/node_modules/raf-schd/dist/raf-schd.esm.js","../../src/use-resize-observer.ts","../../src/use-scroll-to-index.ts","../../src/masonry.tsx","../../src/list.tsx","../../src/use-infinite-loader.ts"],"sourcesContent":["type Color = 0 | 1 | 2;\nconst RED = 0;\nconst BLACK = 1;\nconst NIL = 2;\n\nconst DELETE = 0;\nconst KEEP = 1;\n\ntype ListNode = {\n  index: number;\n  high: number;\n  next: ListNode | null;\n};\n\ninterface TreeNode {\n  max: number;\n  low: number;\n  high: number;\n  // color\n  C: Color;\n  // P\n  P: TreeNode;\n  // right\n  R: TreeNode;\n  // left\n  L: TreeNode;\n  list: ListNode;\n}\n\ninterface Tree {\n  root: TreeNode;\n  size: number;\n}\n\nfunction addInterval(treeNode: TreeNode, high: number, index: number): boolean {\n  let node: ListNode | null = treeNode.list;\n  let prevNode: ListNode | undefined;\n\n  while (node) {\n    if (node.index === index) return false;\n    if (high > node.high) break;\n    prevNode = node;\n    node = node.next;\n  }\n\n  if (!prevNode) treeNode.list = { index, high, next: node };\n  if (prevNode) prevNode.next = { index, high, next: prevNode.next };\n\n  return true;\n}\n\nfunction removeInterval(treeNode: TreeNode, index: number) {\n  let node: ListNode | null = treeNode.list;\n  if (node.index === index) {\n    if (node.next === null) return DELETE;\n    treeNode.list = node.next;\n    return KEEP;\n  }\n\n  let prevNode: ListNode | undefined = node;\n  node = node.next;\n\n  while (node !== null) {\n    if (node.index === index) {\n      prevNode.next = node.next;\n      return KEEP;\n    }\n    prevNode = node;\n    node = node.next;\n  }\n}\n\nconst NULL_NODE: TreeNode = {\n  low: 0,\n  max: 0,\n  high: 0,\n  C: NIL,\n  // @ts-expect-error\n  P: undefined,\n  // @ts-expect-error\n  R: undefined,\n  // @ts-expect-error\n  L: undefined,\n  // @ts-expect-error\n  list: undefined,\n};\n\nNULL_NODE.P = NULL_NODE;\nNULL_NODE.L = NULL_NODE;\nNULL_NODE.R = NULL_NODE;\n\nfunction updateMax(node: TreeNode) {\n  const max = node.high;\n  if (node.L === NULL_NODE && node.R === NULL_NODE) node.max = max;\n  else if (node.L === NULL_NODE) node.max = Math.max(node.R.max, max);\n  else if (node.R === NULL_NODE) node.max = Math.max(node.L.max, max);\n  else node.max = Math.max(Math.max(node.L.max, node.R.max), max);\n}\n\nfunction updateMaxUp(node: TreeNode) {\n  let x = node;\n\n  while (x.P !== NULL_NODE) {\n    updateMax(x.P);\n    x = x.P;\n  }\n}\n\nfunction rotateLeft(tree: Tree, x: TreeNode) {\n  if (x.R === NULL_NODE) return;\n  const y = x.R;\n  x.R = y.L;\n  if (y.L !== NULL_NODE) y.L.P = x;\n  y.P = x.P;\n\n  if (x.P === NULL_NODE) tree.root = y;\n  else if (x === x.P.L) x.P.L = y;\n  else x.P.R = y;\n\n  y.L = x;\n  x.P = y;\n\n  updateMax(x);\n  updateMax(y);\n}\n\nfunction rotateRight(tree: Tree, x: TreeNode) {\n  if (x.L === NULL_NODE) return;\n  const y = x.L;\n  x.L = y.R;\n  if (y.R !== NULL_NODE) y.R.P = x;\n  y.P = x.P;\n\n  if (x.P === NULL_NODE) tree.root = y;\n  else if (x === x.P.R) x.P.R = y;\n  else x.P.L = y;\n\n  y.R = x;\n  x.P = y;\n\n  updateMax(x);\n  updateMax(y);\n}\n\nfunction replaceNode(tree: Tree, x: TreeNode, y: TreeNode) {\n  if (x.P === NULL_NODE) tree.root = y;\n  else if (x === x.P.L) x.P.L = y;\n  else x.P.R = y;\n  y.P = x.P;\n}\n\nfunction fixRemove(tree: Tree, x: TreeNode) {\n  let w;\n\n  while (x !== NULL_NODE && x.C === BLACK) {\n    if (x === x.P.L) {\n      w = x.P.R;\n\n      if (w.C === RED) {\n        w.C = BLACK;\n        x.P.C = RED;\n        rotateLeft(tree, x.P);\n        w = x.P.R;\n      }\n\n      if (w.L.C === BLACK && w.R.C === BLACK) {\n        w.C = RED;\n        x = x.P;\n      } else {\n        if (w.R.C === BLACK) {\n          w.L.C = BLACK;\n          w.C = RED;\n          rotateRight(tree, w);\n          w = x.P.R;\n        }\n\n        w.C = x.P.C;\n        x.P.C = BLACK;\n        w.R.C = BLACK;\n        rotateLeft(tree, x.P);\n        x = tree.root;\n      }\n    } else {\n      w = x.P.L;\n\n      if (w.C === RED) {\n        w.C = BLACK;\n        x.P.C = RED;\n        rotateRight(tree, x.P);\n        w = x.P.L;\n      }\n\n      if (w.R.C === BLACK && w.L.C === BLACK) {\n        w.C = RED;\n        x = x.P;\n      } else {\n        if (w.L.C === BLACK) {\n          w.R.C = BLACK;\n          w.C = RED;\n          rotateLeft(tree, w);\n          w = x.P.L;\n        }\n\n        w.C = x.P.C;\n        x.P.C = BLACK;\n        w.L.C = BLACK;\n        rotateRight(tree, x.P);\n        x = tree.root;\n      }\n    }\n  }\n\n  x.C = BLACK;\n}\n\nfunction minimumTree(x: TreeNode) {\n  while (x.L !== NULL_NODE) x = x.L;\n  return x;\n}\n\nfunction fixInsert(tree: Tree, z: TreeNode) {\n  let y: TreeNode;\n  while (z.P.C === RED) {\n    if (z.P === z.P.P.L) {\n      y = z.P.P.R;\n\n      if (y.C === RED) {\n        z.P.C = BLACK;\n        y.C = BLACK;\n        z.P.P.C = RED;\n        z = z.P.P;\n      } else {\n        if (z === z.P.R) {\n          z = z.P;\n          rotateLeft(tree, z);\n        }\n\n        z.P.C = BLACK;\n        z.P.P.C = RED;\n        rotateRight(tree, z.P.P);\n      }\n    } else {\n      y = z.P.P.L;\n\n      if (y.C === RED) {\n        z.P.C = BLACK;\n        y.C = BLACK;\n        z.P.P.C = RED;\n        z = z.P.P;\n      } else {\n        if (z === z.P.L) {\n          z = z.P;\n          rotateRight(tree, z);\n        }\n\n        z.P.C = BLACK;\n        z.P.P.C = RED;\n        rotateLeft(tree, z.P.P);\n      }\n    }\n  }\n  tree.root.C = BLACK;\n}\n\nexport interface IIntervalTree {\n  insert(low: number, high: number, index: number): void;\n  remove(index: number): void;\n  search(\n    low: number,\n    high: number,\n    callback: (index: number, low: number) => any\n  ): void;\n  size: number;\n}\n\nexport function createIntervalTree(): IIntervalTree {\n  const tree = {\n    root: NULL_NODE,\n    size: 0,\n  };\n  // we know these indexes are a consistent, safe way to make look ups\n  // for our case so it's a solid O(1) alternative to\n  // the O(log n) searchNode() in typical interval trees\n  const indexMap: Record<number, TreeNode> = {};\n\n  return {\n    insert(low, high, index) {\n      let x: TreeNode = tree.root;\n      let y: TreeNode = NULL_NODE;\n\n      while (x !== NULL_NODE) {\n        y = x;\n        if (low === y.low) break;\n        if (low < x.low) x = x.L;\n        else x = x.R;\n      }\n\n      if (low === y.low && y !== NULL_NODE) {\n        if (!addInterval(y, high, index)) return;\n        y.high = Math.max(y.high, high);\n        updateMax(y);\n        updateMaxUp(y);\n        indexMap[index] = y;\n        tree.size++;\n        return;\n      }\n\n      const z: TreeNode = {\n        low,\n        high,\n        max: high,\n        C: RED,\n        P: y,\n        L: NULL_NODE,\n        R: NULL_NODE,\n        list: { index, high, next: null },\n      };\n\n      if (y === NULL_NODE) {\n        tree.root = z;\n      } else {\n        if (z.low < y.low) y.L = z;\n        else y.R = z;\n        updateMaxUp(z);\n      }\n\n      fixInsert(tree, z);\n      indexMap[index] = z;\n      tree.size++;\n    },\n\n    remove(index) {\n      const z = indexMap[index];\n      if (z === void 0) return;\n      delete indexMap[index];\n\n      const intervalResult = removeInterval(z, index);\n      if (intervalResult === void 0) return;\n      if (intervalResult === KEEP) {\n        z.high = z.list.high;\n        updateMax(z);\n        updateMaxUp(z);\n        tree.size--;\n        return;\n      }\n\n      let y = z;\n      let originalYColor = y.C;\n      let x: TreeNode;\n\n      if (z.L === NULL_NODE) {\n        x = z.R;\n        replaceNode(tree, z, z.R);\n      } else if (z.R === NULL_NODE) {\n        x = z.L;\n        replaceNode(tree, z, z.L);\n      } else {\n        y = minimumTree(z.R);\n        originalYColor = y.C;\n        x = y.R;\n\n        if (y.P === z) {\n          x.P = y;\n        } else {\n          replaceNode(tree, y, y.R);\n          y.R = z.R;\n          y.R.P = y;\n        }\n\n        replaceNode(tree, z, y);\n        y.L = z.L;\n        y.L.P = y;\n        y.C = z.C;\n      }\n\n      updateMax(x);\n      updateMaxUp(x);\n\n      if (originalYColor === BLACK) fixRemove(tree, x);\n      tree.size--;\n    },\n\n    search(low, high, callback) {\n      const stack = [tree.root];\n      while (stack.length !== 0) {\n        const node = stack.pop() as TreeNode;\n        if (node === NULL_NODE || low > node.max) continue;\n        if (node.L !== NULL_NODE) stack.push(node.L);\n        if (node.R !== NULL_NODE) stack.push(node.R);\n        if (node.low <= high && node.high >= low) {\n          let curr: ListNode | null = node.list;\n          while (curr !== null) {\n            if (curr.high >= low) callback(curr.index, node.low);\n            curr = curr.next;\n          }\n        }\n      }\n    },\n\n    get size() {\n      return tree.size;\n    },\n  };\n}\n","import * as React from 'react'\n\nconst useLatest = <T extends any>(current: T) => {\n  const storedValue = React.useRef(current)\n  React.useEffect(() => {\n    storedValue.current = current\n  })\n  return storedValue\n}\n\nexport default useLatest\n","import * as React from 'react'\nimport useLatest from '@react-hook/latest'\n\nexport const useDebounceCallback = <CallbackArgs extends any[]>(\n  callback: (...args: CallbackArgs) => void,\n  wait = 100,\n  leading = false\n): ((...args: CallbackArgs) => void) => {\n  const storedCallback = useLatest(callback)\n  const timeout = React.useRef<ReturnType<typeof setTimeout>>()\n  const deps = [wait, leading, storedCallback]\n  // Cleans up pending timeouts when the deps change\n  React.useEffect(\n    () => () => {\n      timeout.current && clearTimeout(timeout.current)\n      timeout.current = void 0\n    },\n    deps\n  )\n\n  return React.useCallback(function () {\n    // eslint-disable-next-line prefer-rest-params\n    const args = arguments\n    const {current} = timeout\n    // Calls on leading edge\n    if (current === void 0 && leading) {\n      timeout.current = setTimeout(() => {\n        timeout.current = void 0\n      }, wait)\n      // eslint-disable-next-line prefer-spread\n      return storedCallback.current.apply(null, args as any)\n    }\n    // Clear the timeout every call and start waiting again\n    current && clearTimeout(current)\n    // Waits for `wait` before invoking the callback\n    timeout.current = setTimeout(() => {\n      timeout.current = void 0\n      storedCallback.current.apply(null, args as any)\n    }, wait)\n  }, deps)\n}\n\nexport const useDebounce = <State extends any>(\n  initialState: State | (() => State),\n  wait?: number,\n  leading?: boolean\n): [State, React.Dispatch<React.SetStateAction<State>>] => {\n  const state = React.useState(initialState)\n  return [state[0], useDebounceCallback(state[1], wait, leading)]\n}\n","import * as React from 'react'\n\nfunction useEvent<\n  T extends Window = Window,\n  K extends keyof WindowEventMap = keyof WindowEventMap\n>(\n  target: Window | null,\n  type: K,\n  listener: WindowEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent<\n  T extends Document = Document,\n  K extends keyof DocumentEventMap = keyof DocumentEventMap\n>(\n  target: Document | null,\n  type: K,\n  listener: DocumentEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent<\n  T extends HTMLElement = HTMLElement,\n  K extends keyof HTMLElementEventMap = keyof HTMLElementEventMap\n>(\n  target: React.RefObject<T> | T | null,\n  type: K,\n  listener: ElementEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent(target: any, type: any, listener: any, cleanup: any): void {\n  const storedListener = React.useRef(listener)\n  const storedCleanup = React.useRef(cleanup)\n\n  React.useEffect(() => {\n    storedListener.current = listener\n    storedCleanup.current = cleanup\n  })\n\n  React.useEffect(() => {\n    const targetEl = target && 'current' in target ? target.current : target\n    if (!targetEl) return\n\n    let didUnsubscribe = 0\n    function listener(this: any, ...args: any[]) {\n      if (didUnsubscribe) return\n      storedListener.current.apply(this, args)\n    }\n\n    targetEl.addEventListener(type, listener)\n    const cleanup = storedCleanup.current\n\n    return () => {\n      didUnsubscribe = 1\n      targetEl.removeEventListener(type, listener)\n      cleanup && cleanup()\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [target, type])\n}\n\nexport type ElementEventListener<\n  K extends keyof HTMLElementEventMap = keyof HTMLElementEventMap\n> = (this: HTMLElement, ev: HTMLElementEventMap[K]) => any\n\nexport type DocumentEventListener<\n  K extends keyof DocumentEventMap = keyof DocumentEventMap\n> = (this: Document, ev: DocumentEventMap[K]) => any\n\nexport type WindowEventListener<\n  K extends keyof WindowEventMap = keyof WindowEventMap\n> = (this: Document, ev: WindowEventMap[K]) => any\n\nexport default useEvent\n","import {useDebounce} from '@react-hook/debounce'\nimport useEvent from '@react-hook/event'\n\nconst emptyObj = {}\n\nexport interface DebouncedWindowSizeOptions {\n  initialWidth?: number\n  initialHeight?: number\n  wait?: number\n  leading?: boolean\n}\n\nconst win = typeof window === 'undefined' ? null : window\nconst wv =\n  win && typeof win.visualViewport !== 'undefined' ? win.visualViewport : null\nconst getSize = () =>\n  [\n    document.documentElement.clientWidth,\n    document.documentElement.clientHeight,\n  ] as const\n\nexport const useWindowSize = (\n  options: DebouncedWindowSizeOptions = emptyObj\n): readonly [number, number] => {\n  const {wait, leading, initialWidth = 0, initialHeight = 0} = options\n  const [size, setDebouncedSize] = useDebounce<readonly [number, number]>(\n    /* istanbul ignore next */\n    typeof document === 'undefined' ? [initialWidth, initialHeight] : getSize,\n    wait,\n    leading\n  )\n  const setSize = (): void => setDebouncedSize(getSize)\n\n  useEvent(win, 'resize', setSize)\n  // @ts-expect-error\n  useEvent(wv, 'resize', setSize)\n  useEvent(win, 'orientationchange', setSize)\n\n  return size\n}\n\nexport const useWindowHeight = (\n  options?: Omit<DebouncedWindowSizeOptions, 'initialWidth'>\n): number => useWindowSize(options)[1]\n\nexport const useWindowWidth = (\n  options?: Omit<DebouncedWindowSizeOptions, 'initialHeight'>\n): number => useWindowSize(options)[0]\n","const memoOne = <Args extends any[], T extends any>(\n  fn: (...args: Args) => T,\n  areEqual?: AreEqual<Args>\n): OutputFunction<Args, T> => {\n  const equal = areEqual || defaultAreEqual\n  let args: Args, value: any\n\n  return function (): T {\n    return !!args && equal(arguments as any, args)\n      ? value\n      : (value = fn.apply(null, (args = arguments as any)))\n  } as OutputFunction<Args, T>\n}\n\nexport default memoOne\n\nconst defaultAreEqual = (\n  current: IArguments,\n  prev: IArguments | any[]\n): boolean =>\n  current[0] === prev[0] &&\n  current[1] === prev[1] &&\n  current[2] === prev[2] &&\n  current[3] === prev[3]\n\nexport type AreEqual<Args> = (currentArgs: Args, prevArgs: Args) => boolean\nexport type InputFunction = (...args: any[]) => any\nexport type OutputFunction<Args extends any[], T extends any> = (\n  ...args: Args\n) => T\n","class OneKeyMap<K extends any = any, V extends any = any> {\n  set: (k: K, v: V) => void\n  get: (k: K) => V | undefined\n\n  constructor() {\n    let key: K | undefined, val: V | undefined\n    this.get = (k: K): V | undefined => (k === key ? val : void 0)\n    this.set = (k: K, v: V): void => {\n      key = k\n      val = v\n    }\n  }\n}\n\nexport default OneKeyMap\n","export interface MapLike {\n  new (...args: any[]): any\n}\n\nexport type CacheConstructor =\n  | MapConstructor\n  | WeakMapConstructor\n  | MapLike\n  | Record<any, any>\n\ninterface Cache<K = any, V = any> {\n  set: (k: K, v: V) => V\n  get: (k: K) => V\n}\n\nconst createCache = (obj: CacheConstructor): Cache => {\n  try {\n    // @ts-ignore\n    return new obj()\n  } catch (e) {\n    const cache: Record<string, any> = {}\n\n    return {\n      set(k, v): void {\n        cache[k] = v\n      },\n      get(k): any {\n        return cache[k]\n      },\n    }\n  }\n}\n\nconst memo = (\n  constructors: CacheConstructor[]\n): {s: Cache['set']; g: Cache['get']} => {\n  const depth = constructors.length,\n    baseCache = createCache(constructors[0])\n  let base: any\n  let map: any\n  let i: number\n  let node: typeof baseCache\n  const one = depth === 1\n  // quicker access for one and two-argument functions\n  const g1 = (args: IArguments): any =>\n    (base = baseCache.get(args[0])) === void 0 || one ? base : base.get(args[1])\n  const s1 = (args: IArguments, value: any): any => {\n    if (one) baseCache.set(args[0], value)\n    else {\n      if ((base = baseCache.get(args[0])) === void 0) {\n        map = createCache(constructors[1])\n        map.set(args[1], value)\n        baseCache.set(args[0], map)\n      } else {\n        base.set(args[1], value)\n      }\n    }\n\n    return value\n  }\n\n  const g2 = (args: IArguments): any => {\n    node = baseCache\n\n    for (i = 0; i < depth; i++)\n      if ((node = node.get(args[i])) === void 0) return\n\n    return node\n  }\n\n  const s2 = (args: IArguments, value: any): any => {\n    node = baseCache\n\n    for (i = 0; i < depth - 1; i++) {\n      if ((map = node.get(args[i])) === void 0) {\n        map = createCache(constructors[i + 1])\n        node.set(args[i], map)\n        node = map\n      } else {\n        node = map\n      }\n    }\n\n    node.set(args[depth - 1], value)\n    return value\n  }\n\n  return depth < 3 ? {g: g1, s: s1} : {g: g2, s: s2}\n}\n\nconst memoize = <T extends any[], U extends any>(\n  mapConstructors: CacheConstructor[],\n  fn: (...args: T) => U\n): ((...args: T) => U) => {\n  let item: U\n  const {g, s} = memo(mapConstructors)\n  return function () {\n    return (item = g(arguments)) === void 0\n      ? s(arguments, fn.apply(null, arguments as any))\n      : item\n  }\n}\n\nexport default memoize\n","export const elementsCache: WeakMap<Element, number> = new WeakMap();\n","import * as React from \"react\";\n\nexport function useForceUpdate() {\n  const setState = React.useState(emptyObj)[1];\n  return React.useRef(() => setState({})).current;\n}\n\nconst emptyObj = {};\n","import memoizeOne from \"@essentials/memoize-one\";\nimport OneKeyMap from \"@essentials/one-key-map\";\nimport useLatest from \"@react-hook/latest\";\nimport * as React from \"react\";\nimport trieMemoize from \"trie-memoize\";\nimport { elementsCache } from \"./elements-cache\";\nimport { useForceUpdate } from \"./use-force-update\";\nimport type { Positioner } from \"./use-positioner\";\n\n/**\n * This hook handles the render phases of the masonry layout and returns the grid as a React element.\n *\n * @param options - Options for configuring the masonry layout renderer. See `UseMasonryOptions`.\n * @param options.positioner\n * @param options.resizeObserver\n * @param options.items\n * @param options.as\n * @param options.id\n * @param options.className\n * @param options.style\n * @param options.role\n * @param options.tabIndex\n * @param options.containerRef\n * @param options.itemAs\n * @param options.itemStyle\n * @param options.itemHeightEstimate\n * @param options.itemKey\n * @param options.overscanBy\n * @param options.scrollTop\n * @param options.isScrolling\n * @param options.height\n * @param options.render\n * @param options.onRender\n */\nexport function useMasonry<Item>({\n  // Measurement and layout\n  positioner,\n  resizeObserver,\n  // Grid items\n  items,\n  // Container props\n  as: ContainerComponent = \"div\",\n  id,\n  className,\n  style,\n  role = \"grid\",\n  tabIndex = 0,\n  containerRef,\n  // Item props\n  itemAs: ItemComponent = \"div\",\n  itemStyle,\n  itemHeightEstimate = 300,\n  itemKey = defaultGetItemKey,\n  // Rendering props\n  overscanBy = 2,\n  scrollTop,\n  isScrolling,\n  height,\n  render: RenderComponent,\n  onRender,\n}: UseMasonryOptions<Item>) {\n  let startIndex = 0;\n  let stopIndex: number | undefined;\n  const forceUpdate = useForceUpdate();\n  const setItemRef = getRefSetter(positioner, resizeObserver);\n  const itemCount = items.length;\n  const {\n    columnWidth,\n    columnCount,\n    range,\n    estimateHeight,\n    size,\n    shortestColumn,\n  } = positioner;\n  const measuredCount = size();\n  const shortestColumnSize = shortestColumn();\n  const children: React.ReactElement[] = [];\n  const itemRole =\n    role === \"list\" ? \"listitem\" : role === \"grid\" ? \"gridcell\" : undefined;\n  const storedOnRender = useLatest(onRender);\n\n  overscanBy = height * overscanBy;\n  const rangeEnd = scrollTop + overscanBy;\n  const needsFreshBatch =\n    shortestColumnSize < rangeEnd && measuredCount < itemCount;\n\n  range(\n    // We overscan in both directions because users scroll both ways,\n    // though one must admit scrolling down is more common and thus\n    // we only overscan by half the downward overscan amount\n    Math.max(0, scrollTop - overscanBy / 2),\n    rangeEnd,\n    (index, left, top) => {\n      const data = items[index];\n      const key = itemKey(data, index);\n      const phaseTwoStyle: React.CSSProperties = {\n        top,\n        left,\n        width: columnWidth,\n        writingMode: \"horizontal-tb\",\n        position: \"absolute\",\n      };\n\n      /* istanbul ignore next */\n      if (\n        typeof process !== \"undefined\" &&\n        process.env.NODE_ENV !== \"production\"\n      ) {\n        throwWithoutData(data, index);\n      }\n\n      children.push(\n        <ItemComponent\n          key={key}\n          ref={setItemRef(index)}\n          role={itemRole}\n          style={\n            typeof itemStyle === \"object\" && itemStyle !== null\n              ? Object.assign({}, phaseTwoStyle, itemStyle)\n              : phaseTwoStyle\n          }\n        >\n          {createRenderElement(RenderComponent, index, data, columnWidth)}\n        </ItemComponent>\n      );\n\n      if (stopIndex === void 0) {\n        startIndex = index;\n        stopIndex = index;\n      } else {\n        startIndex = Math.min(startIndex, index);\n        stopIndex = Math.max(stopIndex, index);\n      }\n    }\n  );\n\n  if (needsFreshBatch) {\n    const batchSize = Math.min(\n      itemCount - measuredCount,\n      Math.ceil(\n        ((scrollTop + overscanBy - shortestColumnSize) / itemHeightEstimate) *\n          columnCount\n      )\n    );\n\n    let index = measuredCount;\n    const phaseOneStyle = getCachedSize(columnWidth);\n\n    for (; index < measuredCount + batchSize; index++) {\n      const data = items[index];\n      const key = itemKey(data, index);\n\n      /* istanbul ignore next */\n      if (\n        typeof process !== \"undefined\" &&\n        process.env.NODE_ENV !== \"production\"\n      ) {\n        throwWithoutData(data, index);\n      }\n\n      children.push(\n        <ItemComponent\n          key={key}\n          ref={setItemRef(index)}\n          role={itemRole}\n          style={\n            typeof itemStyle === \"object\"\n              ? Object.assign({}, phaseOneStyle, itemStyle)\n              : phaseOneStyle\n          }\n        >\n          {createRenderElement(RenderComponent, index, data, columnWidth)}\n        </ItemComponent>\n      );\n    }\n  }\n\n  // Calls the onRender callback if the rendered indices changed\n  React.useEffect(() => {\n    if (typeof storedOnRender.current === \"function\" && stopIndex !== void 0)\n      storedOnRender.current(startIndex, stopIndex, items);\n\n    didEverMount = \"1\";\n  }, [startIndex, stopIndex, items, storedOnRender]);\n  // If we needed a fresh batch we should reload our components with the measured\n  // sizes\n  React.useEffect(() => {\n    if (needsFreshBatch) forceUpdate();\n    // eslint-disable-next-line\n  }, [needsFreshBatch, positioner]);\n\n  // gets the container style object based upon the estimated height and whether or not\n  // the page is being scrolled\n  const containerStyle = getContainerStyle(\n    isScrolling,\n    estimateHeight(itemCount, itemHeightEstimate)\n  );\n\n  return (\n    <ContainerComponent\n      ref={containerRef}\n      key={didEverMount}\n      id={id}\n      role={role}\n      className={className}\n      tabIndex={tabIndex}\n      style={\n        typeof style === \"object\"\n          ? assignUserStyle(containerStyle, style)\n          : containerStyle\n      }\n      children={children}\n    />\n  );\n}\n\n/* istanbul ignore next */\nfunction throwWithoutData(data: any, index: number) {\n  if (!data) {\n    throw new Error(\n      `No data was found at index: ${index}\\n\\n` +\n        `This usually happens when you've mutated or changed the \"items\" array in a ` +\n        `way that makes it shorter than the previous \"items\" array. Masonic knows nothing ` +\n        `about your underlying data and when it caches cell positions, it assumes you aren't ` +\n        `mutating the underlying \"items\".\\n\\n` +\n        `See https://codesandbox.io/s/masonic-w-react-router-example-2b5f9?file=/src/index.js for ` +\n        `an example that gets around this limitations. For advanced implementations, see ` +\n        `https://codesandbox.io/s/masonic-w-react-router-and-advanced-config-example-8em42?file=/src/index.js\\n\\n` +\n        `If this was the result of your removing an item from your \"items\", see this issue: ` +\n        `https://github.com/jaredLunde/masonic/issues/12`\n    );\n  }\n}\n\n// This is for triggering a remount after SSR has loaded in the client w/ hydrate()\nlet didEverMount = \"0\";\n\nexport interface UseMasonryOptions<Item> {\n  /**\n   * An array containing the data used by the grid items.\n   */\n  items: Item[];\n  /**\n   * A grid cell positioner and cache created by the `usePositioner()` hook or\n   * the `createPositioner` utility.\n   */\n  positioner: Positioner;\n  /**\n   * A resize observer that tracks mutations to the grid cells and forces the\n   * Masonry grid to recalculate its layout if any cells affect column heights\n   * change. Check out the `useResizeObserver()` hook.\n   */\n  resizeObserver?: {\n    observe: ResizeObserver[\"observe\"];\n    disconnect: ResizeObserver[\"observe\"];\n    unobserve: ResizeObserver[\"unobserve\"];\n  };\n  /**\n   * This is the type of element the grid container will be rendered as.\n   *\n   * @default \"div\"`\n   */\n  as?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\n  /**\n   * Optionally gives the grid container an `id` prop.\n   */\n  id?: string;\n  /**\n   * Optionally gives the grid container a `className` prop.\n   */\n  className?: string;\n  /**\n   * Adds extra `style` attributes to the container in addition to those\n   * created by the `useMasonry()` hook.\n   */\n  style?: React.CSSProperties;\n  /**\n   * Optionally swap out the accessibility `role` prop of the container and its items.\n   *\n   * @default \"grid\"\n   */\n  role?: \"grid\" | \"list\";\n  /**\n   * Change the `tabIndex` of the grid container.\n   *\n   * @default 0\n   */\n  tabIndex?: number;\n  /**\n   * Forwards a React ref to the grid container.\n   */\n  containerRef?:\n    | ((element: HTMLElement) => void)\n    | React.MutableRefObject<HTMLElement | null>;\n  /**\n   * This is the type of element the grid items will be rendered as.\n   *\n   * @default \"div\"\n   */\n  itemAs?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\n  /**\n   * Adds extra `style` attributes to the grid items in addition to those\n   * created by the `useMasonry()` hook.\n   */\n  itemStyle?: React.CSSProperties;\n  /**\n   * This value is used for estimating the initial height of the masonry grid. It is important for\n   * the UX of the scrolling behavior and in determining how many `items` to render in a batch, so it's\n   * wise to set this value with some level accuracy, though it doesn't need to be perfect.\n   *\n   * @default 300\n   */\n  itemHeightEstimate?: number;\n  /**\n   * The value returned here must be unique to the item. By default, the key is the item's index. This is ok\n   * if your collection of items is never modified. Setting this property ensures that the component in `render`\n   * is reused each time the masonry grid is reflowed. A common pattern would be to return the item's database\n   * ID here if there is one, e.g. `data => data.id`\n   *\n   * @default (data, index) => index`\n   */\n  itemKey?: (data: Item, index: number) => string | number;\n  /**\n   * This number is used for determining the number of grid cells outside of the visible window to render.\n   * The default value is `2` which means \"render 2 windows worth (2 * `height`) of content before and after\n   * the items in the visible window\". A value of `3` would be 3 windows worth of grid cells, so it's a\n   * linear relationship.\n   *\n   * Overscanning is important for preventing tearing when scrolling through items in the grid, but setting\n   * too high of a vaimport { useForceUpdate } from './use-force-update';\nlue may create too much work for React to handle, so it's best that you tune this\n   * value accordingly.\n   *\n   * @default 2\n   */\n  overscanBy?: number;\n\n  /**\n   * This is the height of the window. If you're rendering the grid relative to the browser `window`,\n   * the current `document.documentElement.clientHeight` is the value you'll want to set here. If you're\n   * rendering the grid inside of another HTML element, you'll want to provide the current `element.offsetHeight`\n   * here.\n   */\n  height: number;\n  /**\n   * The current scroll progress in pixel of the window the grid is rendered in. If you're rendering\n   * the grid relative to the browser `window`, you'll want the most current `window.scrollY` here.\n   * If you're rendering the grid inside of another HTML element, you'll want the current `element.scrollTop`\n   * value here. The `useScroller()` hook and `<MasonryScroller>` components will help you if you're\n   * rendering the grid relative to the browser `window`.\n   */\n  scrollTop: number;\n  /**\n   * This property is used for determining whether or not the grid container should add styles that\n   * dramatically increase scroll performance. That is, turning off `pointer-events` and adding a\n   * `will-change: contents;` value to the style string. You can forgo using this prop, but I would\n   * not recommend that. The `useScroller()` hook and `<MasonryScroller>` components will help you if\n   * you're rendering the grid relative to the browser `window`.\n   *\n   * @default false\n   */\n  isScrolling?: boolean;\n  /**\n   * This component is rendered for each item of your `items` prop array. It should accept three props:\n   * `index`, `width`, and `data`. See RenderComponentProps.\n   */\n  render: React.ComponentType<RenderComponentProps<Item>>;\n  /**\n   * This callback is invoked any time the items currently being rendered by the grid change.\n   */\n  onRender?: (startIndex: number, stopIndex: number, items: Item[]) => void;\n}\n\nexport interface RenderComponentProps<Item> {\n  /**\n   * The index of the cell in the `items` prop array.\n   */\n  index: number;\n  /**\n   * The rendered width of the cell's column.\n   */\n  width: number;\n  /**\n   * The data at `items[index]` of your `items` prop array.\n   */\n  data: Item;\n}\n\n//\n// Render-phase utilities\n\n// ~5.5x faster than createElement without the memo\nconst createRenderElement = trieMemoize(\n  [OneKeyMap, {}, WeakMap, OneKeyMap],\n  (RenderComponent, index, data, columnWidth) => (\n    <RenderComponent index={index} data={data} width={columnWidth} />\n  )\n);\n\nconst getContainerStyle = memoizeOne(\n  (isScrolling: boolean | undefined, estimateHeight: number) => ({\n    position: \"relative\",\n    width: \"100%\",\n    maxWidth: \"100%\",\n    height: Math.ceil(estimateHeight),\n    maxHeight: Math.ceil(estimateHeight),\n    willChange: isScrolling ? \"contents\" : void 0,\n    pointerEvents: isScrolling ? \"none\" : void 0,\n  })\n);\n\nconst cmp2 = (args: IArguments, pargs: IArguments | any[]): boolean =>\n  args[0] === pargs[0] && args[1] === pargs[1];\n\nconst assignUserStyle = memoizeOne(\n  (containerStyle, userStyle) => Object.assign({}, containerStyle, userStyle),\n  // @ts-expect-error\n  cmp2\n);\n\nfunction defaultGetItemKey<Item>(_: Item, i: number) {\n  return i;\n}\n\n// the below memoizations for for ensuring shallow equal is reliable for pure\n// component children\nconst getCachedSize = memoizeOne(\n  (width: number): React.CSSProperties => ({\n    width,\n    zIndex: -1000,\n    visibility: \"hidden\",\n    position: \"absolute\",\n    writingMode: \"horizontal-tb\",\n  }),\n  (args, pargs) => args[0] === pargs[0]\n);\n\nconst getRefSetter = memoizeOne(\n  (\n      positioner: Positioner,\n      resizeObserver?: UseMasonryOptions<any>[\"resizeObserver\"]\n    ) =>\n    (index: number) =>\n    (el: HTMLElement | null): void => {\n      if (el === null) return;\n      if (resizeObserver) {\n        resizeObserver.observe(el);\n        elementsCache.set(el, index);\n      }\n      if (positioner.get(index) === void 0)\n        positioner.set(index, el.offsetHeight);\n    },\n  // @ts-expect-error\n  cmp2\n);\n","export type Raf = (callback: (timestamp: number) => void) => number\nexport type Caf = (handle: number) => void\n\nlet u = 'undefined',\n  win = typeof window !== u ? window : ({} as any),\n  p = typeof performance !== u ? performance : Date,\n  now = () => p.now(),\n  af = 'AnimationFrame' as const,\n  Caf = 'cancel' + af,\n  Raf = 'request' + af,\n  raf: Raf = win[Raf] && win[Raf].bind(win),\n  caf: Caf = win[Caf] && win[Caf].bind(win)\n\nif (!raf || !caf) {\n  let lastTime = 0\n  raf = (callback: FrameRequestCallback) => {\n    let curr = now(),\n      next = Math.max(lastTime + 1000 / 60, curr)\n    return setTimeout(() => {\n      callback((lastTime = next))\n    }, next - curr) as any\n  }\n  caf = (h) => clearTimeout(h)\n}\n\nexport {raf, caf, now}\n","/**\n * Copyright 2011, Joe Lambert.\n * Free to use under the MIT license.\n * http://www.opensource.org/licenses/mit-license.php\n **/\nimport {raf, caf, now} from '@essentials/raf'\n\nexport interface RequestTimeoutHandle {\n  v?: number\n}\n\nexport const clearRequestTimeout = (handle: RequestTimeoutHandle): void => {\n  caf(handle.v || -1)\n}\n\nexport const requestTimeout = (\n  fn: (...args: any[]) => void,\n  ms: number\n): RequestTimeoutHandle => {\n  const start = now(),\n    handle: RequestTimeoutHandle = {}\n\n  const loop = () => {\n    now() - start >= ms ? fn.call(null) : (handle.v = raf(loop))\n  }\n\n  handle.v = raf(loop)\n  return handle\n}\n\nexport default requestTimeout\n","import * as React from 'react'\nimport useLatest from '@react-hook/latest'\n\nconst perf = typeof performance !== 'undefined' ? performance : Date\nconst now = () => perf.now()\n\nexport function useThrottleCallback<CallbackArguments extends any[]>(\n  callback: (...args: CallbackArguments) => void,\n  fps = 30,\n  leading = false\n): (...args: CallbackArguments) => void {\n  const storedCallback = useLatest(callback)\n  const ms = 1000 / fps\n  const prev = React.useRef(0)\n  const trailingTimeout = React.useRef<ReturnType<typeof setTimeout>>()\n  const clearTrailing = () =>\n    trailingTimeout.current && clearTimeout(trailingTimeout.current)\n  const deps = [fps, leading, storedCallback]\n\n  // Reset any time the deps change\n  React.useEffect(\n    () => () => {\n      prev.current = 0\n      clearTrailing()\n    },\n    deps\n  )\n\n  return React.useCallback(function () {\n    // eslint-disable-next-line prefer-rest-params\n    const args = arguments\n    const rightNow = now()\n    const call = () => {\n      prev.current = rightNow\n      clearTrailing()\n      storedCallback.current.apply(null, args as any)\n    }\n    const current = prev.current\n    // leading\n    if (leading && current === 0) return call()\n    // body\n    if (rightNow - current > ms) {\n      if (current > 0) return call()\n      prev.current = rightNow\n    }\n    // trailing\n    clearTrailing()\n    trailingTimeout.current = setTimeout(() => {\n      call()\n      prev.current = 0\n    }, ms)\n  }, deps)\n}\n\nexport function useThrottle<State>(\n  initialState: State | (() => State),\n  fps?: number,\n  leading?: boolean\n): [State, React.Dispatch<React.SetStateAction<State>>] {\n  const state = React.useState<State>(initialState)\n  return [state[0], useThrottleCallback(state[1], fps, leading)]\n}\n","import {useThrottle} from '@react-hook/throttle'\nimport useEvent from '@react-hook/event'\n\nconst win = typeof window === 'undefined' ? null : window\nconst getScrollY = (): number =>\n  (win as Window).scrollY !== void 0\n    ? (win as Window).scrollY\n    : (win as Window).pageYOffset === void 0\n    ? 0\n    : (win as Window).pageYOffset\n\nexport const useWindowScroll = (fps = 30): number => {\n  const state = useThrottle(\n    typeof window === 'undefined' ? 0 : getScrollY,\n    fps,\n    true\n  )\n  useEvent(win, 'scroll', (): void => state[1](getScrollY()))\n  return state[0]\n}\n\nexport default useWindowScroll\n","import {\n  clearRequestTimeout,\n  requestTimeout,\n} from \"@essentials/request-timeout\";\nimport useScrollPosition from \"@react-hook/window-scroll\";\nimport * as React from \"react\";\n\n/**\n * A hook for tracking whether the `window` is currently being scrolled and it's scroll position on\n * the y-axis. These values are used for determining which grid cells to render and when\n * to add styles to the masonry container that maximize scroll performance.\n *\n * @param offset - The vertical space in pixels between the top of the grid container and the top\n *  of the browser `document.documentElement`.\n * @param fps - This determines how often (in frames per second) to update the scroll position of the\n *  browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n *  The default value of `12` has been very reasonable in my own testing, but if you have particularly\n *  heavy `render` components it may be prudent to reduce this number.\n */\nexport function useScroller(\n  offset = 0,\n  fps = 12\n): { scrollTop: number; isScrolling: boolean } {\n  const scrollTop = useScrollPosition(fps);\n  const [isScrolling, setIsScrolling] = React.useState(false);\n  const didMount = React.useRef(0);\n\n  React.useEffect(() => {\n    if (didMount.current === 1) setIsScrolling(true);\n    let didUnsubscribe = false;\n    const to = requestTimeout(() => {\n      if (didUnsubscribe) return;\n      // This is here to prevent premature bail outs while maintaining high resolution\n      // unsets. Without it there will always bee a lot of unnecessary DOM writes to style.\n      setIsScrolling(false);\n    }, 40 + 1000 / fps);\n    didMount.current = 1;\n    return () => {\n      didUnsubscribe = true;\n      clearRequestTimeout(to);\n    };\n  }, [fps, scrollTop]);\n\n  return { scrollTop: Math.max(0, scrollTop - offset), isScrolling };\n}\n","import { useMasonry } from \"./use-masonry\";\nimport type { UseMasonryOptions } from \"./use-masonry\";\nimport { useScroller } from \"./use-scroller\";\n/**\n * A heavily-optimized component that updates `useMasonry()` when the scroll position of the browser `window`\n * changes. This bare-metal component is used by `<Masonry>` under the hood.\n *\n * @param props\n */\nexport function MasonryScroller<Item>(props: MasonryScrollerProps<Item>) {\n  // We put this in its own layer because it's the thing that will trigger the most updates\n  // and we don't want to slower ourselves by cycling through all the functions, objects, and effects\n  // of other hooks\n  const { scrollTop, isScrolling } = useScroller(props.offset, props.scrollFps);\n  // This is an update-heavy phase and while we could just Object.assign here,\n  // it is way faster to inline and there's a relatively low hit to he bundle\n  // size.\n  return useMasonry<Item>({\n    scrollTop,\n    isScrolling,\n    positioner: props.positioner,\n    resizeObserver: props.resizeObserver,\n    items: props.items,\n    onRender: props.onRender,\n    as: props.as,\n    id: props.id,\n    className: props.className,\n    style: props.style,\n    role: props.role,\n    tabIndex: props.tabIndex,\n    containerRef: props.containerRef,\n    itemAs: props.itemAs,\n    itemStyle: props.itemStyle,\n    itemHeightEstimate: props.itemHeightEstimate,\n    itemKey: props.itemKey,\n    overscanBy: props.overscanBy,\n    height: props.height,\n    render: props.render,\n  });\n}\n\nexport interface MasonryScrollerProps<Item>\n  extends Omit<UseMasonryOptions<Item>, \"scrollTop\" | \"isScrolling\"> {\n  /**\n   * This determines how often (in frames per second) to update the scroll position of the\n   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n   * The default value of `12` has been very reasonable in my own testing, but if you have particularly\n   * heavy `render` components it may be prudent to reduce this number.\n   *\n   * @default 12\n   */\n  scrollFps?: number;\n  /**\n   * The vertical space in pixels between the top of the grid container and the top\n   * of the browser `document.documentElement`.\n   *\n   * @default 0\n   */\n  offset?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  MasonryScroller.displayName = \"MasonryScroller\";\n}\n","import React from 'react'\n\nconst usePassiveLayoutEffect =\n  React[\n    typeof document !== 'undefined' && document.createElement !== void 0\n      ? 'useLayoutEffect'\n      : 'useEffect'\n  ]\n\nexport default usePassiveLayoutEffect\n","import useLayoutEffect from \"@react-hook/passive-layout-effect\";\nimport * as React from \"react\";\n\n/**\n * A hook for measuring the width of the grid container, as well as its distance\n * from the top of the document. These values are necessary to correctly calculate the number/width\n * of columns to render, as well as the number of rows to render.\n *\n * @param elementRef - A `ref` object created by `React.useRef()`. That ref should be provided to the\n *   `containerRef` property in `useMasonry()`.\n * @param deps - You can force this hook to recalculate the `offset` and `width` whenever this\n *   dependencies list changes. A common dependencies list might look like `[windowWidth, windowHeight]`,\n *   which would force the hook to recalculate any time the size of the browser `window` changed.\n */\nexport function useContainerPosition(\n  elementRef: React.MutableRefObject<HTMLElement | null>,\n  deps: React.DependencyList = emptyArr\n): ContainerPosition {\n  const [containerPosition, setContainerPosition] =\n    React.useState<ContainerPosition>({ offset: 0, width: 0 });\n\n  useLayoutEffect(() => {\n    const { current } = elementRef;\n    if (current !== null) {\n      let offset = 0;\n      let el = current;\n\n      do {\n        offset += el.offsetTop || 0;\n        el = el.offsetParent as HTMLElement;\n      } while (el);\n\n      if (\n        offset !== containerPosition.offset ||\n        current.offsetWidth !== containerPosition.width\n      ) {\n        setContainerPosition({\n          offset,\n          width: current.offsetWidth,\n        });\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps);\n\n  return containerPosition;\n}\n\nexport interface ContainerPosition {\n  /**\n   * The distance in pixels between the top of the element in `elementRef` and the top of\n   * the `document.documentElement`.\n   */\n  offset: number;\n  /**\n   * The `offsetWidth` of the element in `elementRef`.\n   */\n  width: number;\n}\n\nconst emptyArr: [] = [];\n","import * as React from \"react\";\nimport { createIntervalTree } from \"./interval-tree\";\n\n/**\n * This hook creates the grid cell positioner and cache required by `useMasonry()`. This is\n * the meat of the grid's layout algorithm, determining which cells to render at a given scroll\n * position, as well as where to place new items in the grid.\n *\n * @param options - Properties that determine the number of columns in the grid, as well\n *  as their widths.\n * @param options.columnWidth\n * @param options.width\n * @param deps - This hook will create a new positioner, clearing all existing cached positions,\n *  whenever the dependencies in this list change.\n * @param options.columnGutter\n * @param options.rowGutter\n * @param options.columnCount\n * @param options.maxColumnCount\n * @param options.maxColumnWidth\n */\nexport function usePositioner(\n  {\n    width,\n    columnWidth = 200,\n    columnGutter = 0,\n    rowGutter,\n    columnCount,\n    maxColumnCount,\n    maxColumnWidth,\n  }: UsePositionerOptions,\n  deps: React.DependencyList = emptyArr\n): Positioner {\n  const initPositioner = (): Positioner => {\n    const [computedColumnWidth, computedColumnCount] = getColumns(\n      width,\n      columnWidth,\n      columnGutter,\n      columnCount,\n      maxColumnCount,\n      maxColumnWidth\n    );\n    return createPositioner(\n      computedColumnCount,\n      computedColumnWidth,\n      columnGutter,\n      rowGutter ?? columnGutter\n    );\n  };\n  const positionerRef = React.useRef<Positioner>();\n  if (positionerRef.current === undefined)\n    positionerRef.current = initPositioner();\n\n  const prevDeps = React.useRef(deps);\n  const opts = [\n    width,\n    columnWidth,\n    columnGutter,\n    rowGutter,\n    columnCount,\n    maxColumnCount,\n    maxColumnWidth,\n  ];\n  const prevOpts = React.useRef(opts);\n  const optsChanged = !opts.every((item, i) => prevOpts.current[i] === item);\n\n  if (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n    if (deps.length !== prevDeps.current.length) {\n      throw new Error(\n        \"usePositioner(): The length of your dependencies array changed.\"\n      );\n    }\n  }\n\n  // Create a new positioner when the dependencies or sizes change\n  // Thanks to https://github.com/khmm12 for pointing this out\n  // https://github.com/jaredLunde/masonic/pull/41\n  if (optsChanged || !deps.every((item, i) => prevDeps.current[i] === item)) {\n    const prevPositioner = positionerRef.current;\n    const positioner = initPositioner();\n    prevDeps.current = deps;\n    prevOpts.current = opts;\n\n    if (optsChanged) {\n      const cacheSize = prevPositioner.size();\n      for (let index = 0; index < cacheSize; index++) {\n        const pos = prevPositioner.get(index);\n        positioner.set(index, pos !== void 0 ? pos.height : 0);\n      }\n    }\n\n    positionerRef.current = positioner;\n  }\n\n  return positionerRef.current;\n}\n\nexport interface UsePositionerOptions {\n  /**\n   * The width of the container you're rendering the grid within, i.e. the container\n   * element's `element.offsetWidth`\n   */\n  width: number;\n  /**\n   * The minimum column width. The `usePositioner()` hook will automatically size the\n   * columns to fill their container based upon the `columnWidth` and `columnGutter` values.\n   * It will never render anything smaller than this width unless its container itself is\n   * smaller than its value. This property is optional if you're using a static `columnCount`.\n   *\n   * @default 200\n   */\n  columnWidth?: number;\n  /**\n   * The maximum column width. Calculated column widths will be capped at this value.\n   */\n  maxColumnWidth?: number;\n  /**\n   * This sets the horizontal space between grid columns in pixels. If `rowGutter` is not set, this\n   * also sets the vertical space between cells within a column in pixels.\n   *\n   * @default 0\n   */\n  columnGutter?: number;\n  /**\n   * This sets the vertical space between cells within a column in pixels. If not set, the value of\n   * `columnGutter` is used instead.\n   */\n  rowGutter?: number;\n  /**\n   * By default, `usePositioner()` derives the column count from the `columnWidth`, `columnGutter`,\n   * and `width` props. However, in some situations it is nice to be able to override that behavior\n   * (e.g. creating a `List` component).\n   */\n  columnCount?: number;\n  /**\n   * The upper bound of column count. This property won't work if `columnCount` is set.\n   */\n  maxColumnCount?: number;\n}\n\n/**\n * Creates a cell positioner for the `useMasonry()` hook. The `usePositioner()` hook uses\n * this utility under the hood.\n *\n * @param columnCount - The number of columns in the grid\n * @param columnWidth - The width of each column in the grid\n * @param columnGutter - The amount of horizontal space between columns in pixels.\n * @param rowGutter - The amount of vertical space between cells within a column in pixels (falls back\n * to `columnGutter`).\n */\nexport const createPositioner = (\n  columnCount: number,\n  columnWidth: number,\n  columnGutter = 0,\n  rowGutter = columnGutter\n): Positioner => {\n  // O(log(n)) lookup of cells to render for a given viewport size\n  // Store tops and bottoms of each cell for fast intersection lookup.\n  const intervalTree = createIntervalTree();\n  // Track the height of each column.\n  // Layout algorithm below always inserts into the shortest column.\n  const columnHeights: number[] = new Array(columnCount);\n  // Used for O(1) item access\n  const items: PositionerItem[] = [];\n  // Tracks the item indexes within an individual column\n  const columnItems: number[][] = new Array(columnCount);\n\n  for (let i = 0; i < columnCount; i++) {\n    columnHeights[i] = 0;\n    columnItems[i] = [];\n  }\n\n  return {\n    columnCount,\n    columnWidth,\n    set: (index, height = 0) => {\n      let column = 0;\n\n      // finds the shortest column and uses it\n      for (let i = 1; i < columnHeights.length; i++) {\n        if (columnHeights[i] < columnHeights[column]) column = i;\n      }\n\n      const top = columnHeights[column] || 0;\n      columnHeights[column] = top + height + rowGutter;\n      columnItems[column].push(index);\n      items[index] = {\n        left: column * (columnWidth + columnGutter),\n        top,\n        height,\n        column,\n      };\n      intervalTree.insert(top, top + height, index);\n    },\n    get: (index) => items[index],\n    // This only updates items in the specific columns that have changed, on and after the\n    // specific items that have changed\n    update: (updates) => {\n      const columns: number[] = new Array(columnCount);\n      let i = 0,\n        j = 0;\n\n      // determines which columns have items that changed, as well as the minimum index\n      // changed in that column, as all items after that index will have their positions\n      // affected by the change\n      for (; i < updates.length - 1; i++) {\n        const index = updates[i];\n        const item = items[index];\n        item.height = updates[++i];\n        intervalTree.remove(index);\n        intervalTree.insert(item.top, item.top + item.height, index);\n        columns[item.column] =\n          columns[item.column] === void 0\n            ? index\n            : Math.min(index, columns[item.column]);\n      }\n\n      for (i = 0; i < columns.length; i++) {\n        // bails out if the column didn't change\n        if (columns[i] === void 0) continue;\n        const itemsInColumn = columnItems[i];\n        // the index order is sorted with certainty so binary search is a great solution\n        // here as opposed to Array.indexOf()\n        const startIndex = binarySearch(itemsInColumn, columns[i]);\n        const index = columnItems[i][startIndex];\n        const startItem = items[index];\n        columnHeights[i] = startItem.top + startItem.height + rowGutter;\n\n        for (j = startIndex + 1; j < itemsInColumn.length; j++) {\n          const index = itemsInColumn[j];\n          const item = items[index];\n          item.top = columnHeights[i];\n          columnHeights[i] = item.top + item.height + rowGutter;\n          intervalTree.remove(index);\n          intervalTree.insert(item.top, item.top + item.height, index);\n        }\n      }\n    },\n    // Render all cells visible within the viewport range defined.\n    range: (lo, hi, renderCallback) =>\n      intervalTree.search(lo, hi, (index, top) =>\n        renderCallback(index, items[index].left, top)\n      ),\n    estimateHeight: (itemCount, defaultItemHeight): number => {\n      const tallestColumn = Math.max(0, Math.max.apply(null, columnHeights));\n\n      return itemCount === intervalTree.size\n        ? tallestColumn\n        : tallestColumn +\n            Math.ceil((itemCount - intervalTree.size) / columnCount) *\n              defaultItemHeight;\n    },\n    shortestColumn: () => {\n      if (columnHeights.length > 1) return Math.min.apply(null, columnHeights);\n      return columnHeights[0] || 0;\n    },\n    size(): number {\n      return intervalTree.size;\n    },\n    all(): PositionerItem[] {\n      return items;\n    },\n  };\n};\n\nexport interface Positioner {\n  /**\n   * The number of columns in the grid\n   */\n  columnCount: number;\n  /**\n   * The width of each column in the grid\n   */\n  columnWidth: number;\n  /**\n   * Sets the position for the cell at `index` based upon the cell's height\n   */\n  set: (index: number, height: number) => void;\n  /**\n   * Gets the `PositionerItem` for the cell at `index`\n   */\n  get: (index: number) => PositionerItem | undefined;\n  /**\n   * Updates cells based on their indexes and heights\n   * positioner.update([index, height, index, height, index, height...])\n   */\n  update: (updates: number[]) => void;\n  /**\n   * Searches the interval tree for grid cells with a `top` value in\n   * betwen `lo` and `hi` and invokes the callback for each item that\n   * is discovered\n   */\n  range: (\n    lo: number,\n    hi: number,\n    renderCallback: (index: number, left: number, top: number) => void\n  ) => void;\n  /**\n   * Returns the number of grid cells in the cache\n   */\n\n  size: () => number;\n  /**\n   * Estimates the total height of the grid\n   */\n\n  estimateHeight: (itemCount: number, defaultItemHeight: number) => number;\n  /**\n   * Returns the height of the shortest column in the grid\n   */\n\n  shortestColumn: () => number;\n  /**\n   * Returns all `PositionerItem` items\n   */\n  all: () => PositionerItem[];\n}\n\nexport interface PositionerItem {\n  /**\n   * This is how far from the top edge of the grid container in pixels the\n   * item is placed\n   */\n  top: number;\n  /**\n   * This is how far from the left edge of the grid container in pixels the\n   * item is placed\n   */\n  left: number;\n  /**\n   * This is the height of the grid cell\n   */\n  height: number;\n  /**\n   * This is the column number containing the grid cell\n   */\n  column: number;\n}\n\n/* istanbul ignore next */\nconst binarySearch = (a: number[], y: number): number => {\n  let l = 0;\n  let h = a.length - 1;\n\n  while (l <= h) {\n    const m = (l + h) >>> 1;\n    const x = a[m];\n    if (x === y) return m;\n    else if (x <= y) l = m + 1;\n    else h = m - 1;\n  }\n\n  return -1;\n};\n\nconst getColumns = (\n  width = 0,\n  minimumWidth = 0,\n  gutter = 8,\n  columnCount?: number,\n  maxColumnCount?: number,\n  maxColumnWidth?: number\n): [number, number] => {\n  columnCount =\n    columnCount ||\n    Math.min(\n      Math.floor((width + gutter) / (minimumWidth + gutter)),\n      maxColumnCount || Infinity\n    ) ||\n    1;\n  let columnWidth = Math.floor(\n    (width - gutter * (columnCount - 1)) / columnCount\n  );\n\n  // Cap the column width if maxColumnWidth is specified\n  if (maxColumnWidth !== undefined && columnWidth > maxColumnWidth) {\n    columnWidth = maxColumnWidth;\n  }\n\n  return [columnWidth, columnCount];\n};\n\nconst emptyArr: [] = [];\n","var rafSchd = function rafSchd(fn) {\n  var lastArgs = [];\n  var frameId = null;\n\n  var wrapperFn = function wrapperFn() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    lastArgs = args;\n\n    if (frameId) {\n      return;\n    }\n\n    frameId = requestAnimationFrame(function () {\n      frameId = null;\n      fn.apply(void 0, lastArgs);\n    });\n  };\n\n  wrapperFn.cancel = function () {\n    if (!frameId) {\n      return;\n    }\n\n    cancelAnimationFrame(frameId);\n    frameId = null;\n  };\n\n  return wrapperFn;\n};\n\nexport default rafSchd;\n","import rafSchd from \"raf-schd\";\nimport * as React from \"react\";\nimport trieMemoize from \"trie-memoize\";\nimport { elementsCache } from \"./elements-cache\";\nimport { useForceUpdate } from \"./use-force-update\";\nimport type { Positioner } from \"./use-positioner\";\n\n/**\n * Creates a resize observer that forces updates to the grid cell positions when mutations are\n * made to cells affecting their height.\n *\n * @param positioner - The masonry cell positioner created by the `usePositioner()` hook.\n */\nexport function useResizeObserver(positioner: Positioner) {\n  const forceUpdate = useForceUpdate();\n  const resizeObserver = createResizeObserver(positioner, forceUpdate);\n  // Cleans up the resize observers when they change or the\n  // component unmounts\n  React.useEffect(() => () => resizeObserver.disconnect(), [resizeObserver]);\n  return resizeObserver;\n}\n\nconst _handlerForType = rafSchd((target: HTMLElement) => {});\n\ntype IHandler = typeof _handlerForType;\n\n/**\n * Creates a resize observer that fires an `updater` callback whenever the height of\n * one or many cells change. The `useResizeObserver()` hook is using this under the hood.\n *\n * @param positioner - A cell positioner created by the `usePositioner()` hook or the `createPositioner()` utility\n * @param updater - A callback that fires whenever one or many cell heights change.\n */\nexport const createResizeObserver = trieMemoize(\n  [WeakMap],\n  // TODO: figure out a way to test this\n  /* istanbul ignore next */\n  (positioner: Positioner, updater: (updates: number[]) => void) => {\n    const updates: number[] = [];\n\n    const update = rafSchd(() => {\n      if (updates.length > 0) {\n        // Updates the size/positions of the cell with the resize\n        // observer updates\n        positioner.update(updates);\n        updater(updates);\n      }\n      updates.length = 0;\n    });\n\n    const commonHandler = (target: HTMLElement) => {\n      const height = target.offsetHeight;\n      if (height > 0) {\n        const index = elementsCache.get(target);\n        if (index !== void 0) {\n          const position = positioner.get(index);\n          if (position !== void 0 && height !== position.height)\n            updates.push(index, height);\n        }\n      }\n      update();\n    };\n\n    const handlers = new Map<number, IHandler>();\n    const handleEntries: ResizeObserverCallback = (entries) => {\n      let i = 0;\n\n      for (; i < entries.length; i++) {\n        const entry = entries[i];\n        const index = elementsCache.get(entry.target);\n\n        if (index === void 0) continue;\n        let handler = handlers.get(index);\n        if (!handler) {\n          handler = rafSchd(commonHandler);\n          handlers.set(index, handler);\n        }\n        handler(entry.target as HTMLElement);\n      }\n    };\n\n    const ro = new ResizeObserver(handleEntries);\n    // Overrides the original disconnect to include cancelling handling the entries.\n    // Ideally this would be its own method but that would result in a breaking\n    // change.\n    const disconnect = ro.disconnect.bind(ro);\n    ro.disconnect = () => {\n      disconnect();\n      handlers.forEach((handler) => {\n        handler.cancel();\n      });\n    };\n\n    return ro;\n  }\n);\n","import useEvent from \"@react-hook/event\";\nimport useLatest from \"@react-hook/latest\";\nimport { useThrottleCallback } from \"@react-hook/throttle\";\nimport * as React from \"react\";\nimport type { Positioner, PositionerItem } from \"./use-positioner\";\n\n/**\n * A hook that creates a callback for scrolling to a specific index in\n * the \"items\" array.\n *\n * @param positioner - A positioner created by the `usePositioner()` hook\n * @param options - Configuration options\n */\nexport function useScrollToIndex(\n  positioner: Positioner,\n  options: UseScrollToIndexOptions\n) {\n  const {\n    align = \"top\",\n    element = typeof window !== \"undefined\" && window,\n    offset = 0,\n    height = typeof window !== \"undefined\" ? window.innerHeight : 0,\n  } = options;\n  const latestOptions = useLatest({\n    positioner,\n    element,\n    align,\n    offset,\n    height,\n  } as const);\n  const getTarget = React.useRef(() => {\n    const latestElement = latestOptions.current.element;\n    return latestElement && \"current\" in latestElement\n      ? latestElement.current\n      : latestElement;\n  }).current;\n  const [state, dispatch] = React.useReducer(\n    (\n      state: {\n        position: PositionerItem | undefined;\n        index: number | undefined;\n        prevTop: number | undefined;\n      },\n      action:\n        | { type: \"scrollToIndex\"; value: number | undefined }\n        | { type: \"setPosition\"; value: PositionerItem | undefined }\n        | { type: \"setPrevTop\"; value: number | undefined }\n        | { type: \"reset\" }\n    ) => {\n      const nextState = {\n        position: state.position,\n        index: state.index,\n        prevTop: state.prevTop,\n      };\n\n      /* istanbul ignore next */\n      if (action.type === \"scrollToIndex\") {\n        return {\n          position: latestOptions.current.positioner.get(action.value ?? -1),\n          index: action.value,\n          prevTop: void 0,\n        };\n      } else if (action.type === \"setPosition\") {\n        nextState.position = action.value;\n      } else if (action.type === \"setPrevTop\") {\n        nextState.prevTop = action.value;\n      } else if (action.type === \"reset\") {\n        return defaultState;\n      }\n\n      return nextState;\n    },\n    defaultState\n  );\n  const throttledDispatch = useThrottleCallback(dispatch, 15);\n\n  // If we find the position along the way we can immediately take off\n  // to the correct spot.\n  useEvent(getTarget() as Window, \"scroll\", () => {\n    if (!state.position && state.index) {\n      const position = latestOptions.current.positioner.get(state.index);\n\n      if (position) {\n        dispatch({ type: \"setPosition\", value: position });\n      }\n    }\n  });\n\n  // If the top changes out from under us in the case of dynamic cells, we\n  // want to keep following it.\n  const currentTop =\n    state.index !== void 0 &&\n    latestOptions.current.positioner.get(state.index)?.top;\n\n  React.useEffect(() => {\n    const target = getTarget();\n    if (!target) return;\n    const { height, align, offset, positioner } = latestOptions.current;\n\n    if (state.position) {\n      let scrollTop = state.position.top;\n\n      if (align === \"bottom\") {\n        scrollTop = scrollTop - height + state.position.height;\n      } else if (align === \"center\") {\n        scrollTop -= (height - state.position.height) / 2;\n      }\n\n      target.scrollTo(0, Math.max(0, (scrollTop += offset)));\n      // Resets state after 400ms, an arbitrary time I determined to be\n      // still visually pleasing if there is a slow network reply in dynamic\n      // cells\n      let didUnsubscribe = false;\n      const timeout = setTimeout(\n        () => !didUnsubscribe && dispatch({ type: \"reset\" }),\n        400\n      );\n      return () => {\n        didUnsubscribe = true;\n        clearTimeout(timeout);\n      };\n    } else if (state.index !== void 0) {\n      // Estimates the top based upon the average height of current cells\n      let estimatedTop =\n        (positioner.shortestColumn() / positioner.size()) * state.index;\n      if (state.prevTop)\n        estimatedTop = Math.max(estimatedTop, state.prevTop + height);\n      target.scrollTo(0, estimatedTop);\n      throttledDispatch({ type: \"setPrevTop\", value: estimatedTop });\n    }\n  }, [currentTop, state, latestOptions, getTarget, throttledDispatch]);\n\n  return React.useRef((index: number) => {\n    dispatch({ type: \"scrollToIndex\", value: index });\n  }).current;\n}\n\nconst defaultState = {\n  index: void 0,\n  position: void 0,\n  prevTop: void 0,\n} as const;\n\nexport type UseScrollToIndexOptions = {\n  /**\n   * The window element or a React ref for the window element. That is,\n   * this is the grid container.\n   *\n   * @default window\n   */\n  element?: Window | HTMLElement | React.RefObject<HTMLElement> | null;\n  /**\n   * Sets the vertical alignment of the cell within the grid container.\n   *\n   * @default \"top\"\n   */\n  align?: \"center\" | \"top\" | \"bottom\";\n  /**\n   * The height of the grid.\n   *\n   * @default window.innerHeight\n   */\n  height?: number;\n  /**\n   * The vertical space in pixels between the top of the grid container and the top\n   * of the window.\n   *\n   * @default 0\n   */\n  offset?: number;\n};\n","import { useWindowSize } from \"@react-hook/window-size\";\nimport * as React from \"react\";\nimport { MasonryScroller } from \"./masonry-scroller\";\nimport type { MasonryScrollerProps } from \"./masonry-scroller\";\nimport { useContainerPosition } from \"./use-container-position\";\nimport { usePositioner } from \"./use-positioner\";\nimport type { UsePositionerOptions } from \"./use-positioner\";\nimport { useResizeObserver } from \"./use-resize-observer\";\nimport { useScrollToIndex } from \"./use-scroll-to-index\";\nimport type { UseScrollToIndexOptions } from \"./use-scroll-to-index\";\n\n/**\n * A \"batteries included\" masonry grid which includes all of the implementation details below. This component is the\n * easiest way to get off and running in your app, before switching to more advanced implementations, if necessary.\n * It will change its column count to fit its container's width and will decide how many rows to render based upon\n * the height of the browser `window`.\n *\n * @param props\n */\nexport function Masonry<Item>(props: MasonryProps<Item>) {\n  const containerRef = React.useRef<null | HTMLElement>(null);\n  const windowSize = useWindowSize({\n    initialWidth: props.ssrWidth,\n    initialHeight: props.ssrHeight,\n  });\n  const containerPos = useContainerPosition(containerRef, windowSize);\n  const nextProps = Object.assign(\n    {\n      offset: containerPos.offset,\n      width: containerPos.width || windowSize[0],\n      height: windowSize[1],\n      containerRef,\n    },\n    props\n  ) as any;\n  nextProps.positioner = usePositioner(nextProps);\n  nextProps.resizeObserver = useResizeObserver(nextProps.positioner);\n  const scrollToIndex = useScrollToIndex(nextProps.positioner, {\n    height: nextProps.height,\n    offset: containerPos.offset,\n    align:\n      typeof props.scrollToIndex === \"object\"\n        ? props.scrollToIndex.align\n        : void 0,\n  });\n  const index =\n    props.scrollToIndex &&\n    (typeof props.scrollToIndex === \"number\"\n      ? props.scrollToIndex\n      : props.scrollToIndex.index);\n\n  React.useEffect(() => {\n    if (index !== void 0) scrollToIndex(index);\n  }, [index, scrollToIndex]);\n\n  return React.createElement(MasonryScroller, nextProps);\n}\n\nexport interface MasonryProps<Item>\n  extends Omit<\n      MasonryScrollerProps<Item>,\n      \"offset\" | \"width\" | \"height\" | \"containerRef\" | \"positioner\"\n    >,\n    Pick<\n      UsePositionerOptions,\n      | \"columnWidth\"\n      | \"columnGutter\"\n      | \"rowGutter\"\n      | \"columnCount\"\n      | \"maxColumnCount\"\n      | \"maxColumnWidth\"\n    > {\n  /**\n   * Scrolls to a given index within the grid. The grid will re-scroll\n   * any time the index changes.\n   */\n  scrollToIndex?:\n    | number\n    | {\n        index: number;\n        align: UseScrollToIndexOptions[\"align\"];\n      };\n  /**\n   * This is the width that will be used for the browser `window` when rendering this component in SSR.\n   * This prop isn't relevant for client-side only apps.\n   */\n  ssrWidth?: number;\n  /**\n   * This is the height that will be used for the browser `window` when rendering this component in SSR.\n   * This prop isn't relevant for client-side only apps.\n   */\n  ssrHeight?: number;\n  /**\n   * This determines how often (in frames per second) to update the scroll position of the\n   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n   * The default value of `12` has been very reasonable in my own testing, but if you have particularly\n   * heavy `render` components it may be prudent to reduce this number.\n   *\n   * @default 12\n   */\n  scrollFps?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  Masonry.displayName = \"Masonry\";\n}\n","import * as React from \"react\";\nimport { Masonry } from \"./masonry\";\nimport type { MasonryProps } from \"./masonry\";\n\n/**\n * This is just a single-column `<Masonry>` component without column-specific props.\n *\n * @param props\n */\nexport function List<Item>(props: ListProps<Item>) {\n  return (\n    <Masonry<Item>\n      role=\"list\"\n      rowGutter={props.rowGutter}\n      columnCount={1}\n      columnWidth={1}\n      {...props}\n    />\n  );\n}\n\nexport interface ListProps<Item>\n  extends Omit<\n    MasonryProps<Item>,\n    \"columGutter\" | \"columnCount\" | \"columnWidth\"\n  > {\n  /**\n   * The amount of vertical space in pixels to add between the list cells.\n   *\n   * @default 0\n   */\n  rowGutter?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  List.displayName = \"List\";\n}\n","import useLatest from \"@react-hook/latest\";\nimport * as React from \"react\";\n\n/**\n * A utility hook for seamlessly adding infinite scroll behavior to the `useMasonry()` hook. This\n * hook invokes a callback each time the last rendered index surpasses the total number of items\n * in your items array or the number defined in the `totalItems` option.\n *\n * @param loadMoreItems - This callback is invoked when more rows must be loaded. It will be used to\n *  determine when to refresh the list with the newly-loaded data. This callback may be called multiple\n *  times in reaction to a single scroll event, so it's important to memoize its arguments. If you're\n *  creating this callback inside of a functional component, make sure you wrap it in `React.useCallback()`,\n *  as well.\n * @param options\n */\nexport function useInfiniteLoader<Item, T extends LoadMoreItemsCallback<Item>>(\n  loadMoreItems: T,\n  options: UseInfiniteLoaderOptions<Item> = emptyObj\n): LoadMoreItemsCallback<Item> {\n  const {\n    isItemLoaded,\n    minimumBatchSize = 16,\n    threshold = 16,\n    totalItems = 9e9,\n  } = options;\n  const storedLoadMoreItems = useLatest(loadMoreItems);\n  const storedIsItemLoaded = useLatest(isItemLoaded);\n\n  return React.useCallback(\n    (startIndex, stopIndex, items) => {\n      const unloadedRanges = scanForUnloadedRanges(\n        storedIsItemLoaded.current,\n        minimumBatchSize,\n        items,\n        totalItems,\n        Math.max(0, startIndex - threshold),\n        Math.min(totalItems - 1, (stopIndex || 0) + threshold)\n      );\n      // The user is responsible for memoizing their loadMoreItems() function\n      // because we don't want to make assumptions about how they want to deal\n      // with `items`\n      for (let i = 0; i < unloadedRanges.length - 1; ++i)\n        storedLoadMoreItems.current(\n          unloadedRanges[i],\n          unloadedRanges[++i],\n          items\n        );\n    },\n    [\n      totalItems,\n      minimumBatchSize,\n      threshold,\n      storedLoadMoreItems,\n      storedIsItemLoaded,\n    ]\n  );\n}\n\n/**\n * Returns all of the ranges within a larger range that contain unloaded rows.\n *\n * @param isItemLoaded\n * @param minimumBatchSize\n * @param items\n * @param totalItems\n * @param startIndex\n * @param stopIndex\n */\nfunction scanForUnloadedRanges<Item>(\n  isItemLoaded: UseInfiniteLoaderOptions<Item>[\"isItemLoaded\"] = defaultIsItemLoaded,\n  minimumBatchSize: UseInfiniteLoaderOptions<Item>[\"minimumBatchSize\"] = 16,\n  items: any[],\n  totalItems: UseInfiniteLoaderOptions<Item>[\"totalItems\"] = 9e9,\n  startIndex: number,\n  stopIndex: number\n): number[] {\n  const unloadedRanges: number[] = [];\n  let rangeStartIndex: number | undefined,\n    rangeStopIndex: number | undefined,\n    index = startIndex;\n\n  /* istanbul ignore next */\n  for (; index <= stopIndex; index++) {\n    if (!isItemLoaded(index, items)) {\n      rangeStopIndex = index;\n      if (rangeStartIndex === void 0) rangeStartIndex = index;\n    } else if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {\n      unloadedRanges.push(rangeStartIndex, rangeStopIndex);\n      rangeStartIndex = rangeStopIndex = void 0;\n    }\n  }\n\n  // If :rangeStopIndex is not null it means we haven't run out of unloaded rows.\n  // Scan forward to try filling our :minimumBatchSize.\n  if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {\n    const potentialStopIndex = Math.min(\n      Math.max(rangeStopIndex, rangeStartIndex + minimumBatchSize - 1),\n      totalItems - 1\n    );\n\n    /* istanbul ignore next */\n    for (index = rangeStopIndex + 1; index <= potentialStopIndex; index++) {\n      if (!isItemLoaded(index, items)) {\n        rangeStopIndex = index;\n      } else {\n        break;\n      }\n    }\n\n    unloadedRanges.push(rangeStartIndex, rangeStopIndex);\n  }\n\n  // Check to see if our first range ended prematurely.\n  // In this case we should scan backwards to try filling our :minimumBatchSize.\n  /* istanbul ignore next */\n  if (unloadedRanges.length) {\n    let firstUnloadedStart = unloadedRanges[0];\n    const firstUnloadedStop = unloadedRanges[1];\n\n    while (\n      firstUnloadedStop - firstUnloadedStart + 1 < minimumBatchSize &&\n      firstUnloadedStart > 0\n    ) {\n      const index = firstUnloadedStart - 1;\n\n      if (!isItemLoaded(index, items)) {\n        unloadedRanges[0] = firstUnloadedStart = index;\n      } else {\n        break;\n      }\n    }\n  }\n\n  return unloadedRanges;\n}\n\nconst defaultIsItemLoaded = <Item>(index: number, items: Item[]): boolean =>\n  items[index] !== void 0;\n\nexport interface UseInfiniteLoaderOptions<Item> {\n  /**\n   *  A callback responsible for determining the loaded state of each item. Should return `true`\n   * if the item has already been loaded and `false` if not.\n   *\n   * @default (index: number, items: any[]) => boolean\n   */\n  isItemLoaded?: (index: number, items: Item[]) => boolean;\n  /**\n   * The minimum number of new items to be loaded at a time.  This property can be used to\n   * batch requests and reduce HTTP requests.\n   *\n   * @default 16\n   */\n  minimumBatchSize?: number;\n  /**\n   * The threshold at which to pre-fetch data. A threshold X means that new data should start\n   * loading when a user scrolls within X cells of the end of your `items` array.\n   *\n   * @default 16\n   */\n  threshold?: number;\n  /**\n   * The total number of items you'll need to eventually load (if known). This can\n   * be arbitrarily high if not known.\n   *\n   * @default 9e9\n   */\n  totalItems?: number;\n}\n\nexport type LoadMoreItemsCallback<Item> = (\n  startIndex: number,\n  stopIndex: number,\n  items: Item[]\n) => any;\n\nconst emptyObj = {};\n"],"names":["RED","BLACK","NIL","DELETE","KEEP","addInterval","treeNode","high","index","node","list","prevNode","next","removeInterval","NULL_NODE","low","max","C","P","undefined","R","L","updateMax","Math","updateMaxUp","x","rotateLeft","tree","y","root","rotateRight","replaceNode","fixRemove","w","minimumTree","fixInsert","z","createIntervalTree","size","indexMap","insert","remove","intervalResult","originalYColor","search","callback","stack","length","pop","push","curr","useLatest","current","storedValue","React","useRef","useEffect","useDebounceCallback","wait","leading","storedCallback","timeout","deps","clearTimeout","useCallback","args","arguments","setTimeout","apply","useDebounce","initialState","state","useState","useEvent","target","type","listener","cleanup","storedListener","storedCleanup","targetEl","didUnsubscribe","addEventListener","removeEventListener","emptyObj","win","window","wv","visualViewport","getSize","document","documentElement","clientWidth","clientHeight","useWindowSize","options","initialWidth","initialHeight","setDebouncedSize","setSize","memoOne","fn","areEqual","equal","defaultAreEqual","value","prev","OneKeyMap","set","get","key","val","k","v","createCache","obj","cache","e","memo","constructors","depth","baseCache","base","map","i","one","g1","s1","g2","s2","g","s","memoize","mapConstructors","item","elementsCache","WeakMap","useForceUpdate","setState","useMasonry","positioner","resizeObserver","items","as","ContainerComponent","id","className","style","role","tabIndex","containerRef","itemAs","ItemComponent","itemStyle","itemHeightEstimate","itemKey","defaultGetItemKey","overscanBy","scrollTop","isScrolling","height","RenderComponent","render","onRender","startIndex","stopIndex","forceUpdate","setItemRef","getRefSetter","itemCount","columnWidth","columnCount","range","estimateHeight","shortestColumn","measuredCount","shortestColumnSize","children","itemRole","storedOnRender","rangeEnd","needsFreshBatch","left","top","data","phaseTwoStyle","width","writingMode","position","process","throwWithoutData","__reactCreateElement__","createRenderElement","min","batchSize","ceil","phaseOneStyle","getCachedSize","didEverMount","containerStyle","getContainerStyle","assignUserStyle","Error","trieMemoize","memoizeOne","maxWidth","maxHeight","willChange","pointerEvents","cmp2","pargs","userStyle","_","zIndex","visibility","el","observe","offsetHeight","u","p","performance","Date","now","af","Caf","Raf","raf","bind","caf","lastTime","h","clearRequestTimeout","handle","requestTimeout","ms","start","loop","call","perf","useThrottleCallback","fps","trailingTimeout","clearTrailing","rightNow","useThrottle","getScrollY","scrollY","pageYOffset","useWindowScroll","useScroller","offset","useScrollPosition","setIsScrolling","didMount","to","MasonryScroller","props","scrollFps","displayName","usePassiveLayoutEffect","createElement","useContainerPosition","elementRef","emptyArr","containerPosition","setContainerPosition","useLayoutEffect","offsetTop","offsetParent","offsetWidth","usePositioner","columnGutter","rowGutter","maxColumnCount","maxColumnWidth","initPositioner","getColumns","computedColumnWidth","computedColumnCount","createPositioner","positionerRef","prevDeps","opts","prevOpts","optsChanged","every","prevPositioner","cacheSize","pos","intervalTree","columnHeights","Array","columnItems","column","update","updates","columns","j","itemsInColumn","binarySearch","startItem","lo","hi","renderCallback","defaultItemHeight","tallestColumn","all","a","l","m","minimumWidth","gutter","floor","Infinity","rafSchd","lastArgs","frameId","wrapperFn","_len","_key","requestAnimationFrame","cancel","cancelAnimationFrame","useResizeObserver","createResizeObserver","disconnect","handler","updater","commonHandler","handlers","Map","handleEntries","entries","entry","ro","ResizeObserver","forEach","useScrollToIndex","align","element","innerHeight","latestOptions","getTarget","latestElement","useReducer","action","nextState","prevTop","defaultState","dispatch","throttledDispatch","currentTop","scrollTo","estimatedTop","Masonry","windowSize","ssrWidth","ssrHeight","containerPos","nextProps","scrollToIndex","List","useInfiniteLoader","loadMoreItems","isItemLoaded","minimumBatchSize","threshold","totalItems","storedLoadMoreItems","storedIsItemLoaded","unloadedRanges","scanForUnloadedRanges","defaultIsItemLoaded","rangeStartIndex","rangeStopIndex","potentialStopIndex","firstUnloadedStart","firstUnloadedStop"],"mappings":"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"}