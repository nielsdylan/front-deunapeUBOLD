{"version":3,"file":"request-timeout.js","sources":["../../node_modules/@essentials/raf/src/index.ts","../../src/index.ts"],"sourcesContent":["export type Raf = (callback: (timestamp: number) => void) => number\nexport type Caf = (handle: number) => void\n\nlet u = 'undefined',\n  win = typeof window !== u ? window : ({} as any),\n  p = typeof performance !== u ? performance : Date,\n  now = () => p.now(),\n  af = 'AnimationFrame' as const,\n  Caf = 'cancel' + af,\n  Raf = 'request' + af,\n  raf: Raf = win[Raf] && win[Raf].bind(win),\n  caf: Caf = win[Caf] && win[Caf].bind(win)\n\nif (!raf || !caf) {\n  let lastTime = 0\n  raf = (callback: FrameRequestCallback) => {\n    let curr = now(),\n      next = Math.max(lastTime + 1000 / 60, curr)\n    return setTimeout(() => {\n      callback((lastTime = next))\n    }, next - curr) as any\n  }\n  caf = (h) => clearTimeout(h)\n}\n\nexport {raf, caf, now}\n","/**\n * Copyright 2011, Joe Lambert.\n * Free to use under the MIT license.\n * http://www.opensource.org/licenses/mit-license.php\n **/\nimport {raf, caf, now} from '@essentials/raf'\n\nexport interface RequestTimeoutHandle {\n  v?: number\n}\n\nexport const clearRequestTimeout = (handle: RequestTimeoutHandle): void => {\n  caf(handle.v || -1)\n}\n\nexport const requestTimeout = (\n  fn: (...args: any[]) => void,\n  ms: number\n): RequestTimeoutHandle => {\n  const start = now(),\n    handle: RequestTimeoutHandle = {}\n\n  const loop = () => {\n    now() - start >= ms ? fn.call(null) : (handle.v = raf(loop))\n  }\n\n  handle.v = raf(loop)\n  return handle\n}\n\nexport default requestTimeout\n"],"names":["u","win","window","p","performance","Date","now","af","Caf","Raf","raf","bind","caf","lastTime","callback","curr","next","Math","max","setTimeout","h","clearTimeout","requestTimeout","fn","ms","start","handle","v","loop","call"],"mappings":"4MAGA,IAAIA,EAAI,YACNC,SAAaC,SAAWF,EAAIE,OAAU,GACtCC,SAAWC,cAAgBJ,EAAII,YAAcC,KAC7CC,EAAM,kBAAMH,EAAEG,OACdC,EAAK,iBACLC,EAAM,SAAWD,EACjBE,EAAM,UAAYF,EAClBG,EAAWT,EAAIQ,IAAQR,EAAIQ,GAAKE,KAAKV,GACrCW,EAAWX,EAAIO,IAAQP,EAAIO,GAAKG,KAAKV,GAEvC,IAAKS,IAAQE,EAAK,KACZC,EAAW,EACfH,EAAM,SAACI,OACDC,EAAOT,IACTU,EAAOC,KAAKC,IAAIL,EAAW,IAAO,GAAIE,UACjCI,YAAW,WAChBL,EAAUD,EAAWG,KACpBA,EAAOD,IAEZH,EAAM,SAACQ,UAAMC,aAAaD,QCPfE,EAAiB,SAC5BC,EACAC,OAEMC,EAAQnB,IACZoB,EAA+B,UAMjCA,EAAOC,EAAIjB,GAJE,SAAPkB,IACJtB,IAAQmB,EAASD,EAAsBE,EAAOC,EAAIjB,EAAIkB,GAAhCL,EAAGM,KAAK,SAIzBH,yBAhB0B,SAACA,GAClCd,EAAIc,EAAOC,IAAM"}